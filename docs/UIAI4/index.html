<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Developing User Interfaces with GitHub Copilot, Part 4 | AI Practitioner</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Developing User Interfaces with GitHub Copilot, Part 4" />
<meta name="author" content="John Michael Miller" />
<meta property="og:locale" content="en" />
<meta name="description" content="In the conclusion to this series on AI assisted UI development, I’ll have GitHub Copilot (GHC) add client-side sorting to a data table. If you missed any of the previous posts, you can find them here: Part 1, Part 2, and Part 3." />
<meta property="og:description" content="In the conclusion to this series on AI assisted UI development, I’ll have GitHub Copilot (GHC) add client-side sorting to a data table. If you missed any of the previous posts, you can find them here: Part 1, Part 2, and Part 3." />
<link rel="canonical" href="https://blog.pdata.com/UIAI4/" />
<meta property="og:url" content="https://blog.pdata.com/UIAI4/" />
<meta property="og:site_name" content="AI Practitioner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-29T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Developing User Interfaces with GitHub Copilot, Part 4" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"John Michael Miller"},"dateModified":"2025-05-29T00:00:00-07:00","datePublished":"2025-05-29T00:00:00-07:00","description":"In the conclusion to this series on AI assisted UI development, I’ll have GitHub Copilot (GHC) add client-side sorting to a data table. If you missed any of the previous posts, you can find them here: Part 1, Part 2, and Part 3.","headline":"Developing User Interfaces with GitHub Copilot, Part 4","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.pdata.com/UIAI4/"},"url":"https://blog.pdata.com/UIAI4/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://blog.pdata.com/feed.xml" title="AI Practitioner" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">AI Practitioner</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Developing User Interfaces with GitHub Copilot, Part 4</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-05-29T00:00:00-07:00" itemprop="datePublished">May 29, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In the conclusion to this series on AI assisted UI development, I’ll have GitHub Copilot (GHC) add client-side sorting to a data table. If you missed any of the previous posts, you can find them here: <a href="https://www.codemag.com/Blog/AIPractitioner/UIAI1" target="_blank">Part 1</a>, <a href="https://www.codemag.com/Blog/AIPractitioner/UIAI2" target="_blank">Part 2</a>, and <a href="https://www.codemag.com/Blog/AIPractitioner/UIAI3" target="_blank">Part 3</a>.</p>

<p>Whenever data is rendered in a table, users often find it useful to sort the table by the data in one column. Modern UIs often let a user click on a column header to sort. Typically this requires changes to the HTML to trigger the sorting, code changes to sort the data, control the sort direction, and render the sorted data. Style changes are needed to provide user feedback. Sorting by more than one column complicates the implementation.</p>

<p>Rather than hand-coding the changes it could be more effective to ask GHC to attempt the implementation as it will likely be faster and hopefully with good quality. The prompt to GHC and it’s response are enclosed in horizontal lines.</p>

<hr />

<p>Here is the prompt I gave Claude 3.7 Sonnet with the context of the <code class="language-plaintext highlighter-rouge">vSalesFunnelSummary.vue</code>.</p>

<blockquote>
  <p>Prompt: Add the ability to sort the detail-table by Status, Total Deal Value, or Average Age.</p>
</blockquote>

<p>Here is the Copilot response:</p>

<blockquote>
  <p>GHC: # Adding Sorting Functionality to the Sales Funnel Summary Table.
I’ll add the ability to sort the details table by implementing sort functionality on the table headers.</p>
</blockquote>

<h2 id="step-by-step-solution">Step-by-Step Solution:</h2>

<ol>
  <li>Add state variables to track the sort field and direction</li>
  <li>Create a computed property that returns the sorted data</li>
  <li>Implement a toggle sort function</li>
  <li>Update the table headers to be clickable and show sort indicators</li>
  <li>Use the sorted data in the table rendering</li>
</ol>

<hr />

<p>GHC generated a new version of the Vue with several modifications. I’ll talk through what GHC’s modification rather than the entire code listing. If you interested in the rest of the code, it’s included as <a href="#Listing1">Listing 1</a> at the end of the post.
<a id="Back2Article1"> </a></p>

<h3 id="update-the-table-headers-to-be-clickable-and-show-sort-indicators">Update the Table Headers to be Clickable and Show Sort Indicators</h3>

<p>First up are the HTML changes. GHC updated the Status, Total Deal Value, and Average Age column header cells to add the UI and triggers needed to implement the sorting.</p>

<p>The column header cell is interactive: it uses the <code class="language-plaintext highlighter-rouge">@click</code> directive to call a method named <code class="language-plaintext highlighter-rouge">toggleSort</code> with an argument associated with the sorted column (<code class="language-plaintext highlighter-rouge">dealStatus</code>, <code class="language-plaintext highlighter-rouge">totalDealValue</code> and <code class="language-plaintext highlighter-rouge">averageAge</code>) whenever the header is clicked. This suggests that clicking the header will sort the table rows based on the associated field.</p>

<p>The <code class="language-plaintext highlighter-rouge">class="sortable"</code> adds a CSS class to visually indicate that the column can be sorted by adding a hover effect.</p>

<p>Inside the header, there is a conditional <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code> element that displays a sort indicator (an up or down arrow) only if the current value of <code class="language-plaintext highlighter-rouge">sortField</code> matches the associated field. The arrow direction is determined by the value of <code class="language-plaintext highlighter-rouge">sortDirection</code>: an upward arrow (▲) for ascending order and a downward arrow (▼) for descending order. This provides a clear visual cue to users about the current sort state of the column.</p>

<h3 id="use-the-sorted-data-in-the-table-rendering">Use the Sorted Data in the Table Rendering</h3>

<p>The last code change in this section is the change to render the <code class="language-plaintext highlighter-rouge">sortedStatus</code> collection instead of the <code class="language-plaintext highlighter-rouge">summary.byDealStatus</code> collection.</p>

<p>Here are the HTML change to the <strong>vSalesFunnelDetail</strong> Vue.</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.html.png" alt="The HTML change to the vSalesFunnelDetail Vue" /></p>

<p>The style changes for sortable columns are fairly straight forward. The <code class="language-plaintext highlighter-rouge">.sortable</code> class is applied to table headers that users can click to sort data. It changes the cursor to a pointer, signaling interactivity, and disables text selection to prevent accidental highlighting when clicking. The <code class="language-plaintext highlighter-rouge">position: relative;</code> property allows for absolutely positioned child elements, such as the sort indicators.</p>

<p>When a user hovers over a sortable column, the <code class="language-plaintext highlighter-rouge">.sortable:hover</code> selector changes the background color to a light gray (<code class="language-plaintext highlighter-rouge">#f5f5f5</code>), providing visual feedback that the column is interactive. The <code class="language-plaintext highlighter-rouge">.sort-indicator</code> class is used for elements (like arrows or icons) that visually indicate the current sort direction. It adds a small left margin and ensures the indicator is displayed inline with the column header text.</p>

<p>Here are the style changes to the <strong>vSalesFunnelDetail</strong> Vue.</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.html.png" alt="The style changes to the vSalesFunnelDetail Vue" /></p>

<h3 id="add-state-variables-to-track-the-sort-field-and-direction">Add State Variables to Track the Sort Field and Direction</h3>

<p>The first set of code changes defines two reactive variables using Vue’s Composition API and the <code class="language-plaintext highlighter-rouge">ref</code> function. The first variable, <code class="language-plaintext highlighter-rouge">sortField</code>, is initialized with the string <code class="language-plaintext highlighter-rouge">'dealStatus'</code>. This means that, by default, any sorting logic in the component will use the <code class="language-plaintext highlighter-rouge">'dealStatus'</code> property of the data as the field to sort by. The second variable, <code class="language-plaintext highlighter-rouge">sortDirection</code>, is initialized with the string <code class="language-plaintext highlighter-rouge">'asc'</code>, which stands for ascending order which is the default sorting direction.</p>

<p>By using <code class="language-plaintext highlighter-rouge">ref</code>, both <code class="language-plaintext highlighter-rouge">sortField</code> and <code class="language-plaintext highlighter-rouge">sortDirection</code> become reactive references. This means that if their values change (for example, when a user clicks a column header to change the sort order), Vue will automatically update any part of the template or computed properties that depend on these values.</p>

<p>Here are the state variable code changes to the <strong>vSalesFunnelDetail</strong> Vue.</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.script.1.png" alt="The state variable code changes to the vSalesFunnelDetail Vue" /></p>

<h3 id="create-a-computed-property-that-returns-the-sorted-data">Create a Computed Property That Returns the Sorted Data</h3>

<p>The main code changes to implement sorting are defining a computed property called <code class="language-plaintext highlighter-rouge">sortedStatuses</code> and a function called <code class="language-plaintext highlighter-rouge">toggleSort</code> within a Vue component using the Composition API. The purpose of <code class="language-plaintext highlighter-rouge">sortedStatuses</code> is to provide a dynamically sorted array of deal statuses, which is used to display a sortable table in the UI.</p>

<p>The <code class="language-plaintext highlighter-rouge">sortedStatuses</code> computed property first checks if the summary object and its <code class="language-plaintext highlighter-rouge">byDealStatus</code> property are available. If not, it returns an empty array to prevent errors. If the data exists, it creates a shallow copy of the <code class="language-plaintext highlighter-rouge">byDealStatus</code> array and sorts it based on the currently selected sort field and direction. The sorting logic checks if the <code class="language-plaintext highlighter-rouge">sortField</code> is <code class="language-plaintext highlighter-rouge">'dealStatus'</code>; if so, it sorts by the <code class="language-plaintext highlighter-rouge">dealStatus</code> property of each item. Otherwise, it sorts by the property specified by <code class="language-plaintext highlighter-rouge">sortField.value</code>. The sort direction is controlled by <code class="language-plaintext highlighter-rouge">sortDirection.value</code>, toggling between ascending (<code class="language-plaintext highlighter-rouge">'asc'</code>) and descending (<code class="language-plaintext highlighter-rouge">'desc'</code>). The comparison uses subtraction, which works for numeric fields, but could cause issues if the fields are strings (a potential “gotcha” to watch for).</p>

<h3 id="implement-a-toggle-sort-function">Implement a Toggle Sort Function</h3>

<p>The <code class="language-plaintext highlighter-rouge">toggleSort</code> function is used to change the sorting behavior when a user interacts with the UI (for example, by clicking a column header). If the user clicks the same field that’s already being sorted, the function toggles the sort direction. If a new field is selected, it sets that as the new sort field and defaults the direction to ascending.</p>

<p>Here are the main code changes to the <strong>vSalesFunnelDetail</strong> Vue.</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.script.2.png" alt="The main code changes to the vSalesFunnelDetail Vue" /></p>

<p>The final set of changes to the code are modifications to the <code class="language-plaintext highlighter-rouge">setup()</code> function return statement. In this context, the return statement exposes specific variables, computed properties, and functions to the component’s template, making them accessible for data binding and event handling. Here Copilot added <code class="language-plaintext highlighter-rouge">sortField</code>, <code class="language-plaintext highlighter-rouge">sortDirection</code>, <code class="language-plaintext highlighter-rouge">sortedStatuses</code>, and <code class="language-plaintext highlighter-rouge">toggleSort</code>.</p>

<p>By returning these properties and methods, the component ensures they are available for use in the template, supporting dynamic rendering, user interaction, and data presentation.</p>

<p>Here are the code changes to the return in the <strong>vSalesFunnelDetail</strong> Vue</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.script.3.png" alt="The code changes to the return in the vSalesFunnelDetail Vue" /></p>

<h3 id="the-rendered-vsalesfunneldetail-vue">The Rendered vSalesFunnelDetail Vue</h3>

<p>Here is the rendered Vue showing that the Total Deal Value is sorted in descending order:</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.rendered.png" alt="The rendered Vue showing that the Total Deal Value is sorted in descending order" /></p>

<p>This is another good example of GHC making seamless change to a user interface with no more effort than a reasonably accurate prompt. In this case, the first prompt submitted produced something very close to the desired results. Outside of some minor cosmetic changes, the only significant issue with the implementation is that there is some repeating logic that could be eliminated by turning the sortable header into a separate component. I’ll improve the implementation by asking GHC to componentize the sortable table header.</p>

<hr />

<blockquote>
  <p>Prompt: Extract the sortable header as a separate component. Include all of the relevant code, html, and css. Replace the existing implementation with the new component.</p>
</blockquote>

<blockquote>
  <p>GHC: Create a new component for the sortable table header. Import and use the new <code class="language-plaintext highlighter-rouge">SortableHeader</code> component in place of the previous implementation.</p>
</blockquote>

<hr />

<p>Let’s review the suggested changes.</p>

<p>As requested Copilot created a new <code class="language-plaintext highlighter-rouge">SortableHeader</code> Vue. This Vue defines a table header (<code class="language-plaintext highlighter-rouge">&lt;th&gt;</code>) that is designed to be sortable. The <code class="language-plaintext highlighter-rouge">:class</code> binding applies the class <code class="language-plaintext highlighter-rouge">sortable</code> to the header by default, and conditionally adds the <code class="language-plaintext highlighter-rouge">active</code> class if the <code class="language-plaintext highlighter-rouge">isActive</code> property is true. This allows for visual feedback to indicate which column is currently being sorted.</p>

<p>The <code class="language-plaintext highlighter-rouge">@click="onClick"</code> directive attaches a click event handler, so when the header is clicked, it triggers the <code class="language-plaintext highlighter-rouge">onClick</code> method.</p>

<p>Inside the <code class="language-plaintext highlighter-rouge">&lt;th&gt;</code>, the <code class="language-plaintext highlighter-rouge">&lt;slot /&gt;</code> element allows you to insert custom content, such as the column label, from the parent component. If the column is active (i.e., currently being sorted), a <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code> with the class <code class="language-plaintext highlighter-rouge">sort-indicator</code> is displayed. This span shows an upward arrow (▲) if the <code class="language-plaintext highlighter-rouge">sortDirection</code> is <code class="language-plaintext highlighter-rouge">"asc"</code> (ascending), or a downward arrow (▼) if it is <code class="language-plaintext highlighter-rouge">"desc"</code> (descending). This visual cue helps users understand the current sort state of the column.</p>

<p>Here is the new <code class="language-plaintext highlighter-rouge">SortableHeader</code> component HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;th</span> <span class="na">:class=</span><span class="s">"['sortable', { active: isActive }]"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"onClick"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;slot</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">v-if=</span><span class="s">"isActive"</span> <span class="na">class=</span><span class="s">"sort-indicator"</span><span class="nt">&gt;</span>
      {{ sortDirection === "asc" ? "▲" : "▼" }}
    <span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;/th&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>

<p>The component accepts three required properties: <code class="language-plaintext highlighter-rouge">field</code>, <code class="language-plaintext highlighter-rouge">sortField</code>, and <code class="language-plaintext highlighter-rouge">sortDirection</code>, all of which are strings. The <code class="language-plaintext highlighter-rouge">field</code> property identifies which column this header represents. The <code class="language-plaintext highlighter-rouge">sortField</code> property indicates which column is currently being sorted, and <code class="language-plaintext highlighter-rouge">sortDirection</code> specifies the current sort order (for example, <code class="language-plaintext highlighter-rouge">"asc"</code> or <code class="language-plaintext highlighter-rouge">"desc"</code>).</p>

<p>A computed property, <code class="language-plaintext highlighter-rouge">isActive</code>, checks if the current header is the one being sorted by comparing <code class="language-plaintext highlighter-rouge">sortField</code> to <code class="language-plaintext highlighter-rouge">field</code>. This is useful for visually indicating the active sort column in the UI.</p>

<p>The component emits a <code class="language-plaintext highlighter-rouge">toggle-sort</code> event when the header is clicked, passing its <code class="language-plaintext highlighter-rouge">field</code> value as a payload. This allows the parent component to update the sorting state accordingly. The <code class="language-plaintext highlighter-rouge">onClick</code> method handles this event emission.</p>

<p>Here is the new <code class="language-plaintext highlighter-rouge">SortableHeader</code> component script:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
  <span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SortableHeader</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">field</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
      <span class="na">sortField</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
      <span class="na">sortDirection</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="p">},</span>
    <span class="na">emits</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">toggle-sort</span><span class="dl">"</span><span class="p">],</span>
    <span class="na">computed</span><span class="p">:</span> <span class="p">{</span>
      <span class="nf">isActive</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sortField</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">field</span><span class="p">;</span>
      <span class="p">},</span>
    <span class="p">},</span>
    <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
      <span class="nf">onClick</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">$emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">toggle-sort</span><span class="dl">"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">field</span><span class="p">);</span>
      <span class="p">},</span>
    <span class="p">},</span>
  <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">.sortable</code> class gives elements a pointer cursor to indicate interactivity, disables text selection for a smoother user experience, and sets the position to relative, which is often used to position child elements absolutely within the header. The <code class="language-plaintext highlighter-rouge">.sortable:hover</code> selector changes the background color when the user hovers over the header, providing a visual cue that the element is interactive. The <code class="language-plaintext highlighter-rouge">.sort-indicator</code> class adds a small left margin and ensures the indicator (such as an arrow or icon) is displayed inline with the header text. The <code class="language-plaintext highlighter-rouge">.active</code> class makes the font bold, typically used to highlight the currently sorted column.</p>

<p>Because the styles are scoped, they only apply to this component, preventing unintended side effects elsewhere in your application.</p>

<p>Here is the new <code class="language-plaintext highlighter-rouge">SortableHeader</code> component CSS:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style </span><span class="na">scoped</span><span class="nt">&gt;</span>
  <span class="nc">.sortable</span> <span class="p">{</span>
    <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
    <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.sortable</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nx">#f5f5f5</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.sort-indicator</span> <span class="p">{</span>
    <span class="nl">margin-left</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">inline-block</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.active</span> <span class="p">{</span>
    <span class="nl">font-weight</span><span class="p">:</span> <span class="nb">bold</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre></div></div>

<p>Now for the changes to the <strong>vSalesFunnelDetail</strong> Vue. If you interested in the rest of the code, it’s included as <a href="#Listing2">Listing 2</a> at the end of the post.
<a id="Back2article2"> </a></p>

<p>In the HTML, Copilot has replaced the <code class="language-plaintext highlighter-rouge">&lt;th&gt;</code> elements with references to the new <code class="language-plaintext highlighter-rouge">SortableHeader</code> component.</p>

<p>The <code class="language-plaintext highlighter-rouge">field="dealStatus"</code> property tells the component which data field it represents. The <code class="language-plaintext highlighter-rouge">:sortField="sortField"</code> and <code class="language-plaintext highlighter-rouge">:sortDirection="sortDirection"</code> properties are bound to reactive data or computed properties in your parent component, indicating the current field being sorted and the direction of the sort (ascending or descending).</p>

<p>The <code class="language-plaintext highlighter-rouge">@toggle-sort="toggleSort"</code> part is an event listener. When the <code class="language-plaintext highlighter-rouge">SortableHeader</code> emits a <code class="language-plaintext highlighter-rouge">toggle-sort</code> event (when the user clicks the header), it triggers the <code class="language-plaintext highlighter-rouge">toggleSort</code> method in the parent component updating the sorting state.</p>

<p>Here are the changes Copilot made to the <strong>vSalesFunnelDetail</strong> HTML:</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.comp.html.png" alt="The changes Copilot made to the `vSalesFunnelDetail` HTML" /></p>

<p>The import statement brings in the <code class="language-plaintext highlighter-rouge">SortableHeader</code> component from the specified path (<code class="language-plaintext highlighter-rouge">"@/components/SortableHeader.vue"</code>). By importing <code class="language-plaintext highlighter-rouge">SortableHeader</code>, we can use it as a child component within the current Vue component (<code class="language-plaintext highlighter-rouge">vSalesFunnelSummary.vue</code>), promoting code reuse and modularity. Encapsulating the logic and presentation of the sortable table headers in a dedicated component isolates the code in the component from the reset of the app reducing side-effects.</p>

<p>In Vue, the components option is used to locally register other components that you want to use within the template of the current component. By listing <code class="language-plaintext highlighter-rouge">SortableHeader</code> inside the components object, you make it available for use as a custom element (e.g., <code class="language-plaintext highlighter-rouge">&lt;SortableHeader /&gt;</code>) in the template section of <code class="language-plaintext highlighter-rouge">vSalesFunnelSummary.vue</code>.</p>

<p>Here are the changes Copilot made to the <strong>vSalesFunnelDetail</strong> script:</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.comp.script.png" alt="The changes Copilot made to the `vSalesFunnelDetail` script" /></p>

<p>Copilot drops the CSS used by the sortable header in the <strong>vSalesFunnelDetail</strong> Vue. These styles now reside in the <code class="language-plaintext highlighter-rouge">SortableHeader</code> component.</p>

<p>Here are the changes Copilot made to the <strong>vSalesFunnelDetail</strong> CSS:</p>

<p><img src="../assets/images/2025-05-29/vSalesFunnelDetail.comp.syles.png" alt="The changes Copilot made to the `vSalesFunnelDetail` CSS" /></p>

<p>This helps keep the code modular and organized by breaking down complex UIs into smaller, reusable components. The <code class="language-plaintext highlighter-rouge">SortableHeader</code> component can be used in any Vue needing this functionality.</p>

<p>This concludes this series on using AI to develop user interfaces. I’ll likely return to UI development in the future.</p>

<h3 id="feedback-loop">Feedback Loop</h3>

<p>Feedback is always welcome. Please direct it to <a href="mailto:AIP@pdata.com" target="_blank">AIP@pdata.com</a></p>

<h4 id="disclaimer">Disclaimer</h4>

<p>AI contributed to the writing to this blog post, but humans reviewed it, refined it, enhanced it and gave it soul.</p>

<ul>
  <li><strong>Prompts:</strong> I use the /explain prompt assist in describing the code changes.</li>
</ul>

<hr />

<h3 id="listings">Listings</h3>

<h4 id="listing-1"><a id="Listing1">Listing #1</a></h4>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"sales-funnel-summary"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Sales Funnel Summary<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"loading"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-else-if=</span><span class="s">"error"</span><span class="nt">&gt;</span>{{ error }}<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-else</span><span class="nt">&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"summary-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>Total Count<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.count }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Average Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.averageDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Total Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.totalDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Max Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.maxDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Min Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.minDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Average Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.averageAge.toFixed(2) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Max Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.maxAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Min Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.minAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>

      <span class="c">&lt;!-- Replace CSS Funnel with Chart.js Canvas --&gt;</span>
      <span class="nt">&lt;h2&gt;</span>Sales Pipeline<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"chart-container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;canvas</span> <span class="na">ref=</span><span class="s">"chartCanvas"</span><span class="nt">&gt;&lt;/canvas&gt;</span>
      <span class="nt">&lt;/div&gt;</span>

      <span class="nt">&lt;h2&gt;</span>Deals by Status<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"detail-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleSort('dealStatus')"</span> <span class="na">class=</span><span class="s">"sortable"</span><span class="nt">&gt;</span>
              Status
              <span class="nt">&lt;span</span> <span class="na">v-if=</span><span class="s">"sortField === 'dealStatus'"</span> <span class="na">class=</span><span class="s">"sort-indicator"</span><span class="nt">&gt;</span>
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              <span class="nt">&lt;/span&gt;</span>
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Count<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Average Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleSort('totalDealValue')"</span> <span class="na">class=</span><span class="s">"sortable"</span><span class="nt">&gt;</span>
              Total Deal Value
              <span class="nt">&lt;span</span>
                <span class="na">v-if=</span><span class="s">"sortField === 'totalDealValue'"</span>
                <span class="na">class=</span><span class="s">"sort-indicator"</span>
              <span class="nt">&gt;</span>
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              <span class="nt">&lt;/span&gt;</span>
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Max Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Min Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleSort('averageAge')"</span> <span class="na">class=</span><span class="s">"sortable"</span><span class="nt">&gt;</span>
              Average Age
              <span class="nt">&lt;span</span> <span class="na">v-if=</span><span class="s">"sortField === 'averageAge'"</span> <span class="na">class=</span><span class="s">"sort-indicator"</span><span class="nt">&gt;</span>
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              <span class="nt">&lt;/span&gt;</span>
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Max Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Min Age<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr</span> <span class="na">v-for=</span><span class="s">"status in sortedStatuses"</span> <span class="na">:key=</span><span class="s">"status.dealStatus"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>
              <span class="nt">&lt;strong&gt;</span>{{ getDealStatusDescription(status.dealStatus) }}<span class="nt">&lt;/strong&gt;</span>
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.count }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.averageDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.totalDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.maxDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.minDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.averageAge.toFixed(2) }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.maxAge }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.minAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">onMounted</span><span class="p">,</span> <span class="nx">computed</span><span class="p">,</span> <span class="nx">watch</span><span class="p">,</span> <span class="nx">nextTick</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">getSalesFunnelSummary</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/services/leadService</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">Chart</span><span class="p">,</span> <span class="nx">registerables</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chart.js</span><span class="dl">"</span><span class="p">;</span>

  <span class="c1">// Register Chart.js components</span>
  <span class="nx">Chart</span><span class="p">.</span><span class="nf">register</span><span class="p">(...</span><span class="nx">registerables</span><span class="p">);</span>

  <span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SalesFunnelSummary</span><span class="dl">"</span><span class="p">,</span>
    <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">summary</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">loading</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">error</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">chartCanvas</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">chart</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="c1">// Add sort state variables</span>
      <span class="kd">const</span> <span class="nx">sortField</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">dealStatus</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">sortDirection</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">fetchSalesFunnelSummary</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">getSalesFunnelSummary</span><span class="p">();</span>
          <span class="k">if </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">error</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span>
              <span class="nx">response</span><span class="p">.</span><span class="nx">failureInformation</span> <span class="o">||</span>
              <span class="dl">"</span><span class="s2">Failed to fetch sales funnel summary</span><span class="dl">"</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">error</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Failed to fetch sales funnel summary</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
          <span class="nx">loading</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="kd">const</span> <span class="nx">getDealStatusDescription</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dealStatus</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">statusMap</span> <span class="o">=</span> <span class="p">{</span>
          <span class="mi">0</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Unknown</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Initial Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Serious Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Contract Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">4</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Won)</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">5</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Lost)</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">6</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Abandoned)</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="nx">statusMap</span><span class="p">[</span><span class="nx">dealStatus</span><span class="p">]</span> <span class="o">||</span> <span class="s2">`Status </span><span class="p">${</span><span class="nx">dealStatus</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
      <span class="p">};</span>

      <span class="kd">const</span> <span class="nx">formatCurrency</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Intl</span><span class="p">.</span><span class="nc">NumberFormat</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">style</span><span class="p">:</span> <span class="dl">"</span><span class="s2">currency</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">currency</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USD</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">}).</span><span class="nf">format</span><span class="p">(</span><span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="c1">// Computed property for filtered funnel stages</span>
      <span class="kd">const</span> <span class="nx">funnelStages</span> <span class="o">=</span> <span class="nf">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>

        <span class="c1">// Filter out "Unknown" (0) and "Closed Lost" (5)</span>
        <span class="k">return</span> <span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span>
          <span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">status</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">includes</span><span class="p">(</span><span class="nx">status</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">))</span>
          <span class="p">.</span><span class="nf">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">dealStatus</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">);</span>
      <span class="p">});</span>

      <span class="c1">// Add computed property for sorted statuses</span>
      <span class="kd">const</span> <span class="nx">sortedStatuses</span> <span class="o">=</span> <span class="nf">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>

        <span class="k">return</span> <span class="p">[...</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">].</span><span class="nf">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">let</span> <span class="nx">aValue</span><span class="p">,</span> <span class="nx">bValue</span><span class="p">;</span>

          <span class="k">if </span><span class="p">(</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">dealStatus</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">aValue</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">;</span>
            <span class="nx">bValue</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aValue</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span><span class="p">];</span>
            <span class="nx">bValue</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span><span class="p">];</span>
          <span class="p">}</span>

          <span class="k">if </span><span class="p">(</span><span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">aValue</span> <span class="o">-</span> <span class="nx">bValue</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">bValue</span> <span class="o">-</span> <span class="nx">aValue</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">});</span>
      <span class="p">});</span>

      <span class="c1">// Add sort toggle function</span>
      <span class="kd">const</span> <span class="nx">toggleSort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Toggle direction if clicking the same field</span>
          <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="c1">// Set new field and default to ascending</span>
          <span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">;</span>
          <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="c1">// Render the Chart.js chart</span>
      <span class="kd">const</span> <span class="nx">renderChart</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">chartCanvas</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

        <span class="c1">// Destroy existing chart if it exists</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">chart</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">chart</span><span class="p">.</span><span class="nf">destroy</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">chartCanvas</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">getContext</span><span class="p">(</span><span class="dl">"</span><span class="s2">2d</span><span class="dl">"</span><span class="p">);</span>

        <span class="c1">// Prepare data for chart</span>
        <span class="kd">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">stage</span><span class="p">)</span> <span class="o">=&gt;</span>
          <span class="nf">getDealStatusDescription</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">),</span>
        <span class="p">);</span>
        <span class="kd">const</span> <span class="nx">counts</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">stage</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">stage</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>

        <span class="c1">// Color palette for chart bars</span>
        <span class="kd">const</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span>
          <span class="dl">"</span><span class="s2">rgba(52, 152, 219, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(46, 134, 193, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(40, 116, 166, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(33, 97, 140, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(26, 82, 118, 0.8)</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">];</span>

        <span class="kd">const</span> <span class="nx">borderColors</span> <span class="o">=</span> <span class="p">[</span>
          <span class="dl">"</span><span class="s2">rgb(52, 152, 219)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgb(46, 134, 193)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgb(40, 116, 166)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgb(33, 97, 140)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgb(26, 82, 118)</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">];</span>

        <span class="c1">// Create the chart</span>
        <span class="nx">chart</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Chart</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">labels</span><span class="p">:</span> <span class="nx">labels</span><span class="p">,</span>
            <span class="na">datasets</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="na">label</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Number of Deals</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">counts</span><span class="p">,</span>
                <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">colors</span><span class="p">,</span>
                <span class="na">borderColor</span><span class="p">:</span> <span class="nx">borderColors</span><span class="p">,</span>
                <span class="na">borderWidth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="p">},</span>
            <span class="p">],</span>
          <span class="p">},</span>
          <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">indexAxis</span><span class="p">:</span> <span class="dl">"</span><span class="s2">y</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Horizontal bar chart</span>
            <span class="na">responsive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">maintainAspectRatio</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">plugins</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">tooltip</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">callbacks</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">label</span><span class="p">:</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">dataIndex</span><span class="p">;</span>
                    <span class="kd">const</span> <span class="nx">stage</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
                    <span class="k">return</span> <span class="s2">`Count: </span><span class="p">${</span><span class="nx">stage</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2"> deals`</span><span class="p">;</span>
                  <span class="p">},</span>
                  <span class="na">afterLabel</span><span class="p">:</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">dataIndex</span><span class="p">;</span>
                    <span class="kd">const</span> <span class="nx">stage</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
                    <span class="k">return</span> <span class="p">[</span>
                      <span class="s2">`Total: </span><span class="p">${</span><span class="nf">formatCurrency</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">totalDealValue</span><span class="p">)}</span><span class="s2">`</span><span class="p">,</span>
                      <span class="s2">`Avg Age: </span><span class="p">${</span><span class="nx">stage</span><span class="p">.</span><span class="nx">averageAge</span><span class="p">.</span><span class="nf">toFixed</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span><span class="s2"> days`</span><span class="p">,</span>
                    <span class="p">];</span>
                  <span class="p">},</span>
                <span class="p">},</span>
              <span class="p">},</span>
              <span class="na">legend</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">display</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// Hide legend</span>
              <span class="p">},</span>
            <span class="p">},</span>
            <span class="na">scales</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">x</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">beginAtZero</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="na">title</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">display</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                  <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Number of Deals</span><span class="dl">"</span><span class="p">,</span>
                <span class="p">},</span>
              <span class="p">},</span>
              <span class="na">y</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">title</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">display</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                  <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Pipeline Stage</span><span class="dl">"</span><span class="p">,</span>
                <span class="p">},</span>
              <span class="p">},</span>
            <span class="p">},</span>
          <span class="p">},</span>
        <span class="p">});</span>
      <span class="p">};</span>

      <span class="nf">onMounted</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nf">fetchSalesFunnelSummary</span><span class="p">();</span>
      <span class="p">});</span>

      <span class="c1">// Watch for changes to render chart when data is loaded</span>
      <span class="nf">watch</span><span class="p">(</span><span class="nx">summary</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nf">nextTick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nf">renderChart</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">});</span>

      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">summary</span><span class="p">,</span>
        <span class="nx">loading</span><span class="p">,</span>
        <span class="nx">error</span><span class="p">,</span>
        <span class="nx">chartCanvas</span><span class="p">,</span>
        <span class="nx">getDealStatusDescription</span><span class="p">,</span>
        <span class="nx">formatCurrency</span><span class="p">,</span>
        <span class="nx">funnelStages</span><span class="p">,</span>
        <span class="c1">// Add new properties to the return object</span>
        <span class="nx">sortField</span><span class="p">,</span>
        <span class="nx">sortDirection</span><span class="p">,</span>
        <span class="nx">sortedStatuses</span><span class="p">,</span>
        <span class="nx">toggleSort</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">},</span>
  <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;style </span><span class="na">scoped</span><span class="nt">&gt;</span>
  <span class="nc">.summary-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.summary-table</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="nl">padding-left</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.detail-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
    <span class="nl">padding-right</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.detail-table</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
    <span class="nl">padding-right</span><span class="p">:</span> <span class="m">16px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c">/* Chart Container */</span>
  <span class="nc">.chart-container</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">400px</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">900px</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">25px</span> <span class="nb">auto</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nx">#f8f9fa</span><span class="p">;</span>
    <span class="nl">border-radius</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">2px</span> <span class="m">4px</span> <span class="nf">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.05</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nt">h2</span> <span class="p">{</span>
    <span class="nl">margin-top</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">150%</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">h1</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">175%</span><span class="p">;</span>
    <span class="nl">padding-top</span><span class="p">:</span> <span class="m">2%</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c">/* Add styling for sortable columns */</span>
  <span class="nc">.sortable</span> <span class="p">{</span>
    <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
    <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.sortable</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nx">#f5f5f5</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.sort-indicator</span> <span class="p">{</span>
    <span class="nl">margin-left</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">inline-block</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre></div></div>

<h4 id="back-to-main-article"><a href="#Back2Article1">Back to main article</a></h4>

<hr />

<h4 id="listing-2"><a id="Listing2">Listing #2</a></h4>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"sales-funnel-summary"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Sales Funnel Summary<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"loading"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-else-if=</span><span class="s">"error"</span><span class="nt">&gt;</span>{{ error }}<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-else</span><span class="nt">&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"summary-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>Total Count<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.count }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Average Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.averageDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Total Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.totalDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Max Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.maxDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Min Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ formatCurrency(summary.minDealValue) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Average Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.averageAge.toFixed(2) }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Max Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.maxAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">style=</span><span class="s">"width: 200px"</span><span class="nt">&gt;</span>Min Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ summary.minAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>

      <span class="c">&lt;!-- Replace CSS Funnel with Chart.js Canvas --&gt;</span>
      <span class="nt">&lt;h2&gt;</span>Sales Pipeline<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"chart-container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;canvas</span> <span class="na">ref=</span><span class="s">"chartCanvas"</span><span class="nt">&gt;&lt;/canvas&gt;</span>
      <span class="nt">&lt;/div&gt;</span>

      <span class="nt">&lt;h2&gt;</span>Deals by Status<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"detail-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;SortableHeader</span>
              <span class="na">field=</span><span class="s">"dealStatus"</span>
              <span class="na">:sortField=</span><span class="s">"sortField"</span>
              <span class="na">:sortDirection=</span><span class="s">"sortDirection"</span>
              <span class="err">@</span><span class="na">toggle-sort=</span><span class="s">"toggleSort"</span>
            <span class="nt">&gt;</span>
              Status
            <span class="nt">&lt;/SortableHeader&gt;</span>
            <span class="nt">&lt;th&gt;</span>Count<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Average Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;SortableHeader</span>
              <span class="na">field=</span><span class="s">"totalDealValue"</span>
              <span class="na">:sortField=</span><span class="s">"sortField"</span>
              <span class="na">:sortDirection=</span><span class="s">"sortDirection"</span>
              <span class="err">@</span><span class="na">toggle-sort=</span><span class="s">"toggleSort"</span>
            <span class="nt">&gt;</span>
              Total Deal Value
            <span class="nt">&lt;/SortableHeader&gt;</span>
            <span class="nt">&lt;th&gt;</span>Max Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Min Deal Value<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;SortableHeader</span>
              <span class="na">field=</span><span class="s">"averageAge"</span>
              <span class="na">:sortField=</span><span class="s">"sortField"</span>
              <span class="na">:sortDirection=</span><span class="s">"sortDirection"</span>
              <span class="err">@</span><span class="na">toggle-sort=</span><span class="s">"toggleSort"</span>
            <span class="nt">&gt;</span>
              Average Age
            <span class="nt">&lt;/SortableHeader&gt;</span>
            <span class="nt">&lt;th&gt;</span>Max Age<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Min Age<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr</span> <span class="na">v-for=</span><span class="s">"status in sortedStatuses"</span> <span class="na">:key=</span><span class="s">"status.dealStatus"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>
              <span class="nt">&lt;strong&gt;</span>{{ getDealStatusDescription(status.dealStatus) }}<span class="nt">&lt;/strong&gt;</span>
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.count }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.averageDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.totalDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.maxDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
              {{ formatCurrency(status.minDealValue) }}
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.averageAge.toFixed(2) }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.maxAge }}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>{{ status.minAge }}<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">onMounted</span><span class="p">,</span> <span class="nx">computed</span><span class="p">,</span> <span class="nx">watch</span><span class="p">,</span> <span class="nx">nextTick</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">getSalesFunnelSummary</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/services/leadService</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">Chart</span><span class="p">,</span> <span class="nx">registerables</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chart.js</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">import</span> <span class="nx">SortableHeader</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/components/SortableHeader.vue</span><span class="dl">"</span><span class="p">;</span>

  <span class="c1">// Register Chart.js components</span>
  <span class="nx">Chart</span><span class="p">.</span><span class="nf">register</span><span class="p">(...</span><span class="nx">registerables</span><span class="p">);</span>

  <span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SalesFunnelSummary</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
      <span class="nx">SortableHeader</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">summary</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">loading</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">error</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">chartCanvas</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">chart</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="c1">// Add sort state variables</span>
      <span class="kd">const</span> <span class="nx">sortField</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">dealStatus</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">sortDirection</span> <span class="o">=</span> <span class="nf">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">fetchSalesFunnelSummary</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">getSalesFunnelSummary</span><span class="p">();</span>
          <span class="k">if </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">error</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">failureInformation</span> <span class="o">||</span> <span class="dl">"</span><span class="s2">Failed to fetch
                                                      || sales funnel summary</span><span class="dl">"</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">error</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Failed to fetch sales funnel summary</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
          <span class="nx">loading</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="kd">const</span> <span class="nx">getDealStatusDescription</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dealStatus</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">statusMap</span> <span class="o">=</span> <span class="p">{</span>
          <span class="mi">0</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Unknown</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Initial Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Serious Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Contract Discussion</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">4</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Won)</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">5</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Lost)</span><span class="dl">"</span><span class="p">,</span>
          <span class="mi">6</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Closed (Abandoned)</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="nx">statusMap</span><span class="p">[</span><span class="nx">dealStatus</span><span class="p">]</span> <span class="o">||</span> <span class="s2">`Status </span><span class="p">${</span><span class="nx">dealStatus</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
      <span class="p">};</span>

      <span class="kd">const</span> <span class="nx">formatCurrency</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Intl</span><span class="p">.</span><span class="nc">NumberFormat</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">style</span><span class="p">:</span> <span class="dl">"</span><span class="s2">currency</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">currency</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USD</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">}).</span><span class="nf">format</span><span class="p">(</span><span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="c1">// Computed property for filtered funnel stages</span>
      <span class="kd">const</span> <span class="nx">funnelStages</span> <span class="o">=</span> <span class="nf">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>

        <span class="c1">// Filter out "Unknown" (0) and "Closed Lost" (5)</span>
        <span class="k">return</span> <span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">status</span><span class="p">)</span> <span class="o">=&gt;</span>
          <span class="o">!</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">].</span><span class="nf">includes</span><span class="p">(</span><span class="nx">status</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">)).</span><span class="nf">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">a</span><span class="p">.</span><span class="nx">dealStatus</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">);</span>
      <span class="p">});</span>

      <span class="c1">// Add computed property for sorted statuses</span>
      <span class="kd">const</span> <span class="nx">sortedStatuses</span> <span class="o">=</span> <span class="nf">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>

        <span class="k">return</span> <span class="p">[...</span><span class="nx">summary</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">byDealStatus</span><span class="p">].</span><span class="nf">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">let</span> <span class="nx">aValue</span><span class="p">,</span> <span class="nx">bValue</span><span class="p">;</span>

          <span class="k">if </span><span class="p">(</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">dealStatus</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">aValue</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">;</span>
            <span class="nx">bValue</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aValue</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span><span class="p">];</span>
            <span class="nx">bValue</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span><span class="p">];</span>
          <span class="p">}</span>

          <span class="k">if </span><span class="p">(</span><span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">aValue</span> <span class="o">-</span> <span class="nx">bValue</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">bValue</span> <span class="o">-</span> <span class="nx">aValue</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">});</span>
      <span class="p">});</span>

      <span class="c1">// Add sort toggle function</span>
      <span class="kd">const</span> <span class="nx">toggleSort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Toggle direction if clicking the same field</span>
          <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="c1">// Set new field and default to ascending</span>
          <span class="nx">sortField</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">;</span>
          <span class="nx">sortDirection</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">asc</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="c1">// Render the Chart.js chart</span>
      <span class="kd">const</span> <span class="nx">renderChart</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">chartCanvas</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="o">!</span><span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

        <span class="c1">// Destroy existing chart if it exists</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">chart</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">chart</span><span class="p">.</span><span class="nf">destroy</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">chartCanvas</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">getContext</span><span class="p">(</span><span class="dl">"</span><span class="s2">2d</span><span class="dl">"</span><span class="p">);</span>

        <span class="c1">// Prepare data for chart</span>
        <span class="kd">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">stage</span><span class="p">)</span> <span class="o">=&gt;</span>
          <span class="nf">getDealStatusDescription</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">dealStatus</span><span class="p">));</span>
        <span class="kd">const</span> <span class="nx">counts</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">stage</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">stage</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>

        <span class="c1">// Color palette for chart bars</span>
        <span class="kd">const</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">rgba(52, 152, 219, 0.8)</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rgba(46, 134, 193, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(40, 116, 166, 0.8)</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rgba(33, 97, 140, 0.8)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgba(26, 82, 118, 0.8)</span><span class="dl">"</span><span class="p">];</span>

        <span class="kd">const</span> <span class="nx">borderColors</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">rgb(52, 152, 219)</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rgb(46, 134, 193)</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">rgb(40, 116, 166)</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rgb(33, 97, 140)</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rgb(26, 82, 118)</span><span class="dl">"</span><span class="p">];</span>

        <span class="c1">// Create the chart</span>
        <span class="nx">chart</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Chart</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">labels</span><span class="p">:</span> <span class="nx">labels</span><span class="p">,</span>
            <span class="na">datasets</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="na">label</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Number of Deals</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">counts</span><span class="p">,</span>
                <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">colors</span><span class="p">,</span>
                <span class="na">borderColor</span><span class="p">:</span> <span class="nx">borderColors</span><span class="p">,</span>
                <span class="na">borderWidth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="p">},</span>
            <span class="p">],</span>
          <span class="p">},</span>
          <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">indexAxis</span><span class="p">:</span> <span class="dl">"</span><span class="s2">y</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Horizontal bar chart</span>
            <span class="na">responsive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">maintainAspectRatio</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">plugins</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">tooltip</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">callbacks</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">label</span><span class="p">:</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">dataIndex</span><span class="p">;</span>
                    <span class="kd">const</span> <span class="nx">stage</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
                    <span class="k">return</span> <span class="s2">`Count: </span><span class="p">${</span><span class="nx">stage</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2"> deals`</span><span class="p">;</span>
                  <span class="p">},</span>
                  <span class="na">afterLabel</span><span class="p">:</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">dataIndex</span><span class="p">;</span>
                    <span class="kd">const</span> <span class="nx">stage</span> <span class="o">=</span> <span class="nx">funnelStages</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
                    <span class="k">return</span> <span class="p">[</span><span class="s2">`Total: </span><span class="p">${</span><span class="nf">formatCurrency</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">totalDealValue</span><span class="p">)}</span><span class="s2">`</span><span class="p">,</span>
                    <span class="s2">`Avg Age: </span><span class="p">${</span><span class="nx">stage</span><span class="p">.</span><span class="nx">averageAge</span><span class="p">.</span><span class="nf">toFixed</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span><span class="s2"> days`</span><span class="p">];</span>
                  <span class="p">},</span>
                <span class="p">},</span>
              <span class="p">},</span>
              <span class="na">legend</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">display</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// Hide legend</span>
              <span class="p">},</span>
            <span class="p">},</span>
            <span class="na">scales</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">x</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">beginAtZero</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="na">title</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">display</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                  <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Number of Deals</span><span class="dl">"</span><span class="p">,</span>
                <span class="p">},</span>
              <span class="p">},</span>
              <span class="na">y</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">title</span><span class="p">:</span> <span class="p">{</span>
                  <span class="na">display</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                  <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Pipeline Stage</span><span class="dl">"</span><span class="p">,</span>
                <span class="p">},</span>
              <span class="p">},</span>
            <span class="p">},</span>
          <span class="p">},</span>
        <span class="p">});</span>
      <span class="p">};</span>

      <span class="nf">onMounted</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nf">fetchSalesFunnelSummary</span><span class="p">();</span>
      <span class="p">});</span>

      <span class="c1">// Watch for changes to render chart when data is loaded</span>
      <span class="nf">watch</span><span class="p">(</span><span class="nx">summary</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nf">nextTick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nf">renderChart</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">});</span>

      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">summary</span><span class="p">,</span>
        <span class="nx">loading</span><span class="p">,</span>
        <span class="nx">error</span><span class="p">,</span>
        <span class="nx">chartCanvas</span><span class="p">,</span>
        <span class="nx">getDealStatusDescription</span><span class="p">,</span>
        <span class="nx">formatCurrency</span><span class="p">,</span>
        <span class="nx">funnelStages</span><span class="p">,</span>
        <span class="c1">// Add new properties to the return object</span>
        <span class="nx">sortField</span><span class="p">,</span>
        <span class="nx">sortDirection</span><span class="p">,</span>
        <span class="nx">sortedStatuses</span><span class="p">,</span>
        <span class="nx">toggleSort</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">},</span>
  <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;style </span><span class="na">scoped</span><span class="nt">&gt;</span>
  <span class="nc">.summary-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.summary-table</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="nl">padding-left</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.detail-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
    <span class="nl">padding-right</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.detail-table</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
    <span class="nl">padding-right</span><span class="p">:</span> <span class="m">16px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="nf">fit-content</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c">/* Chart Container */</span>
  <span class="nc">.chart-container</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">400px</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">900px</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">25px</span> <span class="nb">auto</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nx">#f8f9fa</span><span class="p">;</span>
    <span class="nl">border-radius</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">2px</span> <span class="m">4px</span> <span class="nf">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.05</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nt">h2</span> <span class="p">{</span>
    <span class="nl">margin-top</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">150%</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">h1</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">175%</span><span class="p">;</span>
    <span class="nl">padding-top</span><span class="p">:</span> <span class="m">2%</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre></div></div>

<h4 id="back-to-main-article-1"><a href="#Back2article2">Back to main article</a></h4>

<p><small><small><small>Original <a href="https://www.codemag.com/blog/AIPractitioner/UIAI4">post</a></small></small></small></p>

  </div><a class="u-url" href="/UIAI4/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">AI Practitioner</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">John Michael Miller</li><li><a class="u-email" href="mailto:AIPractitioner@pdata.com">AIPractitioner@pdata.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>jMM&#39;s AI Practitioner Blog</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
